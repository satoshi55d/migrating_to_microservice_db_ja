## 一貫性モデル

分散システムの一貫性について語るとき、システムのさまざまなノードに分散したデータがあり、そのそれぞれにデータのコピーがあるという概念に言及します。
読み取り専用データセットの場合、ノードに接続しているクライアントは常に同じデータを受信するため、一貫性の問題はありません。
読み書きデータセットに関しては、いくつかの競合が発生する可能性があります。
ノードのそれぞれは、データの独自のコピーを更新することができるため、クライアントがシステム内の別のノードに接続している場合、同じデータに対して異なる値を受け取る可能性があります。

異なるノード上のデータ更新処理方法と、ノード間の情報伝播方法は異なる一貫性モデルにつながります。
次のセクションで説明する「結果整合性」と「強整合性」についての概念を過度に単純化したものですが、
マイクロサービスとリレーショナルデータベースとの間の情報統合のコンテキストの中で、これらを十分に完全に理解すべきです。


#### 結果整合性

結果整合性とは、データセット内のデータ項目への更新が与えられた場合、「最終的には」将来のある時点ではどのノードでもこのデータ項目へのすべてのアクセスが同じ値を返すことを保証する分散コンピューティングのモデルです。
ノードのそれぞれがデータ項目のそれ自身のコピーを更新することができるので、2つ以上のノードが同じデータ項目を変更すると、競合が発生します。
コンバージェンス[^1]を達成するには「競合解消アルゴリズム」が必要となります。
競合解消アルゴリズムの一例は、「最後の書き込みを正とする」です。
すべての更新プログラムに同期タイムスタンプまたはカウンタを追加できれば、最後の更新は常に競合に勝ちます。

結果整合性の特別なケースの1つは、データを複数のノードに分散しているけれど、そのうちの1つだけがデータを更新することができる場合です。
あるノードが更新情報の標準的な情報源である場合、正規情報源とまったく同じ順序で更新を適用できる限り、他のノードに競合は生じません。
書き込み不可に設定することはビジネスのユースケースによっては許容できるトレードオフです。
このテーマについては、56ページの「イベント・ソーシング」で詳しく説明します。

[^1]:コンバージェンスとは、システムのすべてのノードが最終的に一貫性を達成した状態です。

#### 強整合性

強整合性は、アトミック性、一貫性、分離性および耐久性（ACID）特性を持つ従来のトランザクションモデルに似ているため、データベース開発者にとって最もよくなじみのあるモデルです。
このモデルでは、どのノードの更新でも、すべてのノードがクライアントの読み取りのために表示される前に新しい値に同意する必要があります。
それは単純に聞こえますが、ノードの一貫性が保たれるまで全ノードをブロックするという要件を許容することになります。
これは、ネットワークのレイテンシとスループットによっては特に問題になるかもしれません。


#### 適応性